groups:
  - name: targets.rules
    rules:

      - alert: AlertmanagerDown
        annotations:
          title: Alertmanager target is missing
          description: Alertmanager has disappeared from Prometheus target discovery.
        expr: absent(up{job="gitlab-monitoring-promethe-alertmanager",namespace="monitoring"} == 1)
        for: 15m
        labels:
          severity: s3

      - alert: KubeDNS
        annotations:
          title: KubeDNS target is missing
          description: KubeDNS has disappeared from Prometheus target discovery.
        expr: absent(up{job="kube-dns"} == 1)
        for: 15m
        labels:
          severity: s3

      - alert: KubeAPIDown
        annotations:
          title: KubeAPI target is missing
          description: KubeAPI has disappeared from Prometheus target discovery.
        expr: absent(up{job="apiserver"} == 1)
        for: 15m
        labels:
          severity: s3

      - alert: KubeStateMetricsDown
        annotations:
          title: KubeStateMetrics target is missing
          description: KubeStateMetrics has disappeared from Prometheus target discovery.
        expr: absent(up{job="kube-state-metrics"} == 1)
        for: 15m
        labels:
          severity: s3

      - alert: KubeletDown
        annotations:
          title: Kubelet target is missing
          description: Kubelet has disappeared from Prometheus target discovery.
        expr: absent(up{job="kubelet"} == 1)
        for: 15m
        labels:
          severity: s3

      - alert: NodeExporterDown
        annotations:
          title: Node Exporter target is missing
          description: NodeExporter has disappeared from Prometheus target discovery.
        expr: absent(up{job="node-exporter"} == 1)
        for: 15m
        labels:
          severity: s3

      - alert: PrometheusDown
        annotations:
          title: Prometheus taarget is missing
          description: Prometheus has disappeared from Prometheus target discovery.
        expr: absent(up{job="gitlab-monitoring-promethe-prometheus",namespace="monitoring"} == 1)
        for: 15m
        labels:
          severity: s3

      - alert: PrometheusOperatorDown
        annotations:
          title: Prometheus Operator target is missing
          description: PrometheusOperator has disappeared from Prometheus target discovery.
        expr: absent(up{job="gitlab-monitoring-promethe-operator",namespace="monitoring"} == 1)
        for: 15m
        labels:
          severity: s3

      - alert: ProductionRegistry
        annotations:
          title: Registry Target is missing
          description: Registry has disappeared from Prometheus target discovery.
        expr: absent(up{job="gitlab-registry",namespace="gitlab"} == 1)
        for: 15m
        labels:
          severity: s3
