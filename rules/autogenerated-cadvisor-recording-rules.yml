# WARNING. DO NOT EDIT THIS FILE BY HAND. USE ./rules-jsonnet/kube-cadvisor-recording-rules.jsonnet TO GENERATE IT
# YOUR CHANGES WILL BE OVERRIDDEN
groups:
- name: kube-cadvisor-recording-rules
  interval: 1m
  rules:
  - record: container_memory_usage_bytes:labelled
    expr: |
      min without(label_queue_pod_name, label_stage, label_type)
      (
        label_replace(
          label_replace(
            label_replace(
              container_memory_usage_bytes{ }
              *
              on(pod, cluster) group_left(label_type, label_stage, label_queue_pod_name)
              kube_pod_labels{
                label_type!=""
              },
              "shard", "$1", "label_queue_pod_name", "(.*)"
            ),
            "stage", "$1", "label_stage", "(.*)"
          ),
          "type", "$1", "label_type", "(.*)"
        )
      )
  - record: container_memory_cache:labelled
    expr: |
      min without(label_queue_pod_name, label_stage, label_type)
      (
        label_replace(
          label_replace(
            label_replace(
              container_memory_cache{ }
              *
              on(pod, cluster) group_left(label_type, label_stage, label_queue_pod_name)
              kube_pod_labels{
                label_type!=""
              },
              "shard", "$1", "label_queue_pod_name", "(.*)"
            ),
            "stage", "$1", "label_stage", "(.*)"
          ),
          "type", "$1", "label_type", "(.*)"
        )
      )
  - record: container_memory_swap:labelled
    expr: |
      min without(label_queue_pod_name, label_stage, label_type)
      (
        label_replace(
          label_replace(
            label_replace(
              container_memory_swap{ }
              *
              on(pod, cluster) group_left(label_type, label_stage, label_queue_pod_name)
              kube_pod_labels{
                label_type!=""
              },
              "shard", "$1", "label_queue_pod_name", "(.*)"
            ),
            "stage", "$1", "label_stage", "(.*)"
          ),
          "type", "$1", "label_type", "(.*)"
        )
      )
  - record: container_spec_memory_limit_bytes:labelled
    expr: |
      min without(label_queue_pod_name, label_stage, label_type)
      (
        label_replace(
          label_replace(
            label_replace(
              container_spec_memory_limit_bytes{ }
              *
              on(pod, cluster) group_left(label_type, label_stage, label_queue_pod_name)
              kube_pod_labels{
                label_type!=""
              },
              "shard", "$1", "label_queue_pod_name", "(.*)"
            ),
            "stage", "$1", "label_stage", "(.*)"
          ),
          "type", "$1", "label_type", "(.*)"
        )
      )
