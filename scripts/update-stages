#!/usr/bin/env ruby

require 'uri'
require 'net/http'
require 'yaml'

url = URI("https://gitlab.com/gitlab-com/www-gitlab-com/raw/master/data/stages.yml")

http = Net::HTTP.new(url.host, url.port)
http.use_ssl = true

request = Net::HTTP::Get.new(url)
response = http.request(request)

File.open("#{__dir__}/../services/stages.yml", 'w') do |file|
  file.puts(<<~HEADER_COMMENT)
    #
    # This file contains a list of all feature categories in GitLab
    # It is generated from the stages file at #{url}.
    # If you would like to update it, please run
    # `./scripts/update-stages` to generate a new copy
    #
    # PLEASE DO NOT EDIT THIS FILE MANUALLY.
    #
  HEADER_COMMENT
  file.write(response.read_body)
end
