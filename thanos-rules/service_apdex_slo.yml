groups:
- name: GitLab Apdex SLO observance status
  partial_response_strategy: "warn"
  interval: 1m
  rules:
  - record: 'slo_observation_status'
    labels:
      slo: 'apdex_ratio'
    expr: >
      clamp_min(avg_over_time(gitlab_service_apdex:ratio{monitor!="global"}[1m]) >= ignoring(environment, stage) group_left slo:min:gitlab_service_apdex:ratio{monitor!="global"}, 1)
      or
      clamp_max(avg_over_time(gitlab_service_apdex:ratio{monitor!="global"}[1m]) < ignoring(environment, stage) group_left slo:min:gitlab_service_apdex:ratio{monitor!="global"}, 0)
