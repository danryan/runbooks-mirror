ALERT GitLabComLatencyGitaly
  IF gitaly:grpc_server_handling_seconds:p95{environment="prd"} >= 60
  FOR 5m
  LABELS {severity="warn"}
  ANNOTATIONS {
    title="Gitaly latency on {{ $labels.fqdn }} has been over {{$value}} during the last 5m",
    description="Reach out to the Gitaly team and mitigate the problem restarting gitaly on the affected node if it's causing a partial outage."
  }

ALERT GitLabComLatencyWeb
  IF type:rails_requests_completed_milliseconds:p95{environment="prd",type="web"} > 3000
  FOR 1m
  LABELS {severity="warn"}
  ANNOTATIONS {
    title="Web latency on GitLab.com has been over {{$value}} ms during the last 1m"
    description="This might be causing a slowdown on the site and/or affecting users. Please check the Triage Dashboard in Grafana."
  }

ALERT GitLabComLatencyAPI
  IF type:rails_requests_completed_milliseconds:p95{environment="prd",type="api"} > 120
  FOR 1m
  LABELS {severity="warn"}
  ANNOTATIONS {
    title="API latency on GitLab.com has been over {{$value}} ms during the last 1m"
    description="This might be causing a slowdown on the site and/or affecting users. Please check the Triage Dashboard in Grafana."
  }
