groups:
- name: gitlab-com-latency.rules
  rules:
  - alert: GitLabComLatencyWeb
    expr: type:rails_requests_completed_seconds:p95{environment=~"gprd",type="web", status="200"}
      > 2000
    for: 1m
    labels:
      severity: warn
    annotations:
      description: This might be causing a slowdown on the site and/or affecting users.
        Please check the Triage Dashboard in Grafana.
      title: Web latency on GitLab.com has been over 2s during the last 1m
  - alert: GitLabComLatencyWebCritical
    expr: type:rails_requests_completed_seconds:p95{environment=~"gprd",type="web", status="200"}
      > 2000
    for: 5m
    labels:
      pager: pagerduty
      severity: critical
    annotations:
      description: This might be causing a slowdown on the site and/or affecting users.
        Please check the Triage Dashboard in Grafana.
      title: Web latency on GitLab.com has been over 2s during the last 5m
  - alert: GitLabComLatencyAPI
    expr: type:rails_requests_completed_seconds:p95{environment=~"gprd",type="api", status="200"}
      > 1500
    for: 1m
    labels:
      severity: warn
    annotations:
      description: This might be causing a slowdown on the site and/or affecting users.
        Please check the Triage Dashboard in Grafana.
      title: API latency on GitLab.com has been over 1500ms during the last 5m
  - alert: GitLabComLatencyAPICritical
    expr: type:rails_requests_completed_seconds:p95{environment=~"gprd",type="api", status="200"}
      > 1500
    for: 5m
    labels:
      severity: critical
    annotations:
      description: This might be causing a slowdown on the site and/or affecting users.
        Please check the Triage Dashboard in Grafana.
      title: API latency on GitLab.com has been over 1500ms during the last 5m
  - alert: GitLabComLatencyGit
    expr: type:rails_requests_completed_seconds:p95{environment=~"gprd",type="api", status="200"}
      > 450
    for: 1m
    labels:
      severity: warn
    annotations:
      description: This might be causing a slowdown on the site and/or affecting users.
        Please check the Triage Dashboard in Grafana.
      title: Git latency on GitLab.com has been over 450ms during the last 5m
  - alert: GitLabComLatencyGitCritical
    expr: type:rails_requests_completed_seconds:p95{environment=~"gprd",type="api", status="200"}
      > 450
    for: 5m
    labels:
      severity: critical
    annotations:
      description: This might be causing a slowdown on the site and/or affecting users.
        Please check the Triage Dashboard in Grafana.
      title: Git latency on GitLab.com has been over 450ms during the last 5m
