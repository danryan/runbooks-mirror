# GitLab Runbooks

[[_TOC_]]

## Overview

This folder is containing a documentation directory for each service as defined
in the [service catalog](../services/service-catalog.yml). Documentation not
belonging to a specific service is in the directory
[uncategorized](uncategorized/).

For each service, there is a file <service-name>/service-<service-name>.md
autogenerated. Other documentation can be freely added in additional files in
each services' directory.

## Suggested Runbook Structure

Runbooks should be the main source of truth for maintaining a service. This
means we need to document all necessary information about a service here. On the
other hand, runbooks should be a concise list of actions without distracting
with too many information. Therefore, the following structure for each service
directory is suggested - in accordance with the structure suggested by the
[service readiness review
template](https://gitlab.com/gitlab-com/gl-infra/readiness/-/blob/master/.gitlab/issue_templates/service_readiness.md).

```
  docs/
    <service-name>
      service-<service-name>.md  # autogenerated
      overview.md                # generic information as defined below 
      <runbook-1>.md
      <runbook-2>.md
```

### Service Overview

The `overview.md` for each service should give background information helpful
for understanding and operating it. It should contain the following sections, as
required by the [service readiness review
template](https://gitlab.com/gitlab-com/gl-infra/readiness/-/blob/master/.gitlab/issue_templates/service_readiness.md) (see there for details):

```
[[_TOC_]]

# Summary

# Architecture

# Performance

# Scalability

# Availability

# Durability

# Security/Compliance

# Monitoring/Alerting

# Links to further Documentation
```

### Runbooks

Runbooks are instructions for the execution of a manual task. Several runbooks
can be described in one document or each runbook can be in it's own file. The
main points to considere are readability, if the runbook is easy to find (naming
of file or runbook header) and that the runbook can be linked to from an alert.

General principles: runbooks should be

* as short and concise as possible
* avoid duplication of information - link to overview.md for general information
* complete enough to be executed without further research
* all structured in the same way, to make it easy to navigate

#### Suggested Runbook Layout

Runbooks are most often used to mitigate issues / react to alerts. Therefore
runbooks for alerts should be simply structured by describing symptom, cause and
solution:

```
[[_TOC_]]

# Symptom: CPU saturated

You got a CPU saturation alert...

## Cause A: User is doing too many request

A user is making too many requests.

Identifyable by:

* List of Alerts
* List of metrics
* List of log searches
* ...

### Solution

Block the user:

* steps
* to
* block
* the user

## Cause B: DDOS Attack

Identifyable by:

* List of alerts
* List of metrics
* List of log searches
* ...

### Solution

<Cloudflare DDOS runbook link>

```

